---
title: npm-scriptsã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹
publishDate: 2022/09/13
updatedDate: 2022/09/14
tags: ['npm', 'ç’°å¢ƒæ§‹ç¯‰', 'Node.js']
draft: false
---

import Msg from '../../../components/post/Msg.astro';

ã“ã‚Œã¾ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«é–¢ä¿‚ã¯VSCodeã®æ‹¡å¼µæ©Ÿèƒ½ã«é ¼ã‚Šãã‚Šã§ã—ãŸã€‚  
ã—ã‹ã—ï¼æ‹¡å¼µæ©Ÿèƒ½ã¯å’æ¥­ã—ãŸã„ï¼ã‚³ãƒ¼ãƒ€ãƒ¼ã½ãnpm-scriptã§ä¹—ã‚Šåˆ‡ã‚ŠãŸã„ï¼ï¼ï¼  
æœ€è¿‘npmã«å°‘ã—æ…£ã‚Œã¦ããŸã¨ã“ã‚ãªã®ã§ã€ã¾ãšã¯ç°¡å˜ãªã¨ã“ã‚ã‹ã‚‰ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã™ã€‚

## npm-scriptsã¨ã¯

npmã§è¡Œã†ã‚¿ã‚¹ã‚¯å‡¦ç†ã®ã“ã¨ã€‚  
*package.json*ã®scriptsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã—ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²ãƒ»å®Ÿè¡Œã§ãã‚‹ã€‚  
ã¤ã¾ã‚ŠWebpackãªã©ã®ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã‚ãšã«ã‚¿ã‚¹ã‚¯å‡¦ç†ãŒã§ãã¦è»½é‡ã‹ã¤ã‚·ãƒ³ãƒ—ãƒ«ğŸ™Œ  
ç°¡å˜ãªã‚¿ã‚¹ã‚¯å‡¦ç†ã‚’è¡Œã„ãŸã„ã¨ãã«ä¾¿åˆ©ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚

## ä»Šå›ã®ç›®æ¨™

- Sassã¨TypeScriptã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨åœ§ç¸®
- CSSã«ã¯ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¤ã‘ã¦ãŠããŸã„
- ãã—ã¦ãã‚Œã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚»ãƒ¼ãƒ–ã™ã‚‹ãŸã³ã«å®Ÿè¡Œã—ã¦ã»ã—ã„ğŸ™„

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‰ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜ã€‚

```title="Directory"
â””â”€src
    â”œâ”€js
    |  â”œâ”€...
    |  â””â”€main.js
    â””â”€sass
        â”œâ”€...
        â””â”€style.scss
```

ã“ã‚„ã¤ã‚‰ã‚’*dist*ã¸ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã„ããŸã„ã€‚

```title="Directory"
â”œâ”€src
|   â”œâ”€js
|   |  â”œâ”€...
|   |  â””â”€main.ts
|   â””â”€sass
|       â”œâ”€...
|       â””â”€style.scss
â””â”€dist
    â”œâ”€js
    |   â””â”€main.js
    â””â”€css
        â””â”€style.css
```

## ã‚„ã£ã¦ã¿ã‚‹

- Node - v16.15.1
- npm - 8.12.1

### Sass

ã¾ãšã¯Sassã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```title="command"
npm i -D sass
```

Sassã§ã‚„ã‚‹ã“ã¨çµ‚ã‚ã‚Šã€‚

### PostCSS

CSSã«ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¤ã‘ã‚‹autoprefixerã¯ã€PostCSSã‚‚å¿…è¦ãªã®ã§ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚  
ã¾ãŸã€postcss-cliã¯PostCSSã‚’ã‚³ãƒãƒ³ãƒ‰ã§ä½¿ã†ãŸã‚ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã®ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```title="command"
npm i -D postcss postcss-cli autoprefixer
```

PostCSSã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ_postcss.config.cjs_ï¼‰ã«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®autoprefixerä½¿ã†ã‚ˆï½ã¨è¨˜è¿°ã€‚

```jsx title="postcss.config.cjs"
module.exports = {
  plugins: {
    autoprefixer: {},
  },
};
```

ãã—ã¦[browserslist](https://github.com/browserslist/browserslist)ï¼ˆã‚µãƒãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªã‚¹ãƒˆåŒ–ã—ãŸã‚‚ã®ï¼‰ã‚’*package.json*ã¸è¨˜è¿°ã€‚

```json title="package.json"
...
},
  "browserslist": [
    "last 2 versions",
    "> 5%",
    "Firefox ESR",
    "not dead"
  ]
}
```

ã¡ãªã¿ã«ä»Šå›ã¯â€¦

- 2ã¤å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¾ã§
- ä½¿ç”¨ç‡5%ä»¥ä¸Š
- FirefixESRã‚‚å¯¾å¿œã—ã¨ã„ã¦ã­
- 24ã‹æœˆé–“ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ãªã„ãƒ–ãƒ©ã‚¦ã‚¶ã¯é™¤å¤–ã­

ã¨ã„ã†å†…å®¹ã«è¨­å®šã—ã¦ã¾ã™ã€‚

### TypeScript

æœ€å¾Œã«TypeScriptã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```title="command"
npm i -g typescript
```

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ_tsconfig.json_ï¼‰ã§ã€è‡ªåˆ†çš„ã«æ³¨æ„ã—ã¦ãŠããŸã„ç®‡æ‰€ã¯â€¦

- noEmitã¯falseã«ãªã£ã¦ã„ã‚‹ã‹
- includeï¼ˆå‚ç…§å…ˆï¼‰ã¨ outDirï¼ˆå‡ºåŠ›å…ˆï¼‰ã‚’å¿˜ã‚Œãšã«
- rootDirï¼ˆå‡ºåŠ›æ™‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªéšå±¤å‚ç…§å…ˆï¼‰ã‚‚å¿…è¦ã§ã‚ã‚Œã°è¨­å®šã—ã¦ãŠã

### npm-scripts

å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæƒã£ãŸã®ã§ã€scriptsã‚’ã‹ã„ã¦ã„ãã¾ã™ã€‚

#### TypeScriptã®ã‚¿ã‚¹ã‚¯

```json title="package.json"
"scripts": {
    "watch:ts": "tsc -w"
  },
```

- `-wï¼ˆâ€”watchï¼‰`ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ã‚’ç›£è¦–

#### Sassã®ã‚¿ã‚¹ã‚¯

```json title="package.json"
"scripts": {
    ...,
    "watch:sass": "sass src/sass/style.scss dist/css/style.css --style compressed --no-source-map -w"
  },
```

æ—¥æœ¬èªã«ã—ã¦ã¿ã‚‹ã¨â€¦  
`sass [å‚ç…§å…ˆ] [å‡ºåŠ›å…ˆ] [--style åœ§ç¸®ã‚¹ã‚¿ã‚¤ãƒ«] [ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ä¸è¦] [ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã®ç›£è¦–]`

#### PostCSSã®ã‚¿ã‚¹ã‚¯

```json title="package.json"
"scripts": {
    ...,
    "watch:postcss": "postcss -u autoprefixer -b 'last 2 versions, > 5%, Firefox ESR, not dead' dist/css/style.css -o dist/css/style.css -w"
  },
```

æ—¥æœ¬èªã«ã—ã¦ã¿ã‚‹ã¨â€¦  
`postcss -u(â€”use)[ä½¿ç”¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³] -b[browserslistæŒ‡å®š] [å‚ç…§å…ˆ] -o(--output) [å‡ºåŠ›å…ˆ] [ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã®ç›£è¦–]`

ã“ã“ã§browserslistãŒä¸Šæ‰‹ãåŠ¹ã‹ãšã‚¨ãƒ©ãƒ¼åãã®ã§ã€scriptsç›´æ›¸ãã¸å¤‰æ›´â€¦

<Msg type="add" date={frontmatter.updatedDate}>
ã“ã‚Œã§browserslistã‚’ç›´æ›¸ãã—ãªãã¦ã‚‚ã„ã‘ãŸï¼

```json title="package.json"
"watch:postcss": "postcss dist/css/style.css -u autoprefixer -o dist/css/style.css -w"
```

æœ€åˆã«å‚ç…§å…ˆã‚’æ›¸ã‹ãªã„ã¨ã„ã‘ãªã‹ã£ãŸã¿ãŸã„ã€‚
å…¬å¼documentã®ä¸€ç•ªæœ€åˆã«ã‹ã„ã¦ã‚ã£ãŸğŸ˜‡

</Msg>

#### ã¾ã¨ã‚ã¦å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã¾ã¨ã‚ã¦å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€npm-run-allã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```json title="command"
npm i -D npm-run-all
```

```json title="package.json"
"scripts": {
    "start": "npm-run-all -p watch:*",
    ...
  },
```

æ—¥æœ¬èªã«ã—ã¦ã¿ã‚‹ã¨â€¦  
`npm-run-all -p(â€”parallel) [watch:ãŒå…ˆé ­ã«ã¤ãã‚‚ã®]`

- `-p`ï¼šä¸¦åˆ—å®Ÿè¡Œï¼ˆåŒæ™‚ã«å®Ÿè¡Œï¼‰

### å®Œæˆ

```json title="package.json"
"scripts": {
   "start": "npm-run-all -p watch:*",
   "watch:ts": "tsc -w",
   "watch:sass": "sass src/sass/style.scss dist/css/style.css --style compressed --no-source-map -w",
   "watch:postcss": "postcss -u autoprefixer -b 'last 2 versions, > 5%, Firefox ESR, not dead' dist/css/style.css -o dist/css/style.css -w"
 },
```

ã“ã‚Œã§ç„¡äº‹ç†æƒ³ã¨ã™ã‚‹ã‚¿ã‚¹ã‚¯ãŒå®Œæˆã§ã™ã€‚  
`npm run start`ã¨ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¦ã°ã€ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ãŒã‚ã‚‹ãŸã³ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ğŸ¥³  
ã¡ãªã¿ã«ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ç›£è¦–ã‚’çµ‚äº†ã•ã›ãŸã„ã¨ãã¯`Ctrl + C`

## ãŠã‚ã‚Š

VSCodeã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼æ‹¡å¼µæ©Ÿèƒ½ã€ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ğŸ™

ãã‚Œã§ã¯ã€ â˜ï¸ ã¼ã‚“ã£

## å‚è€ƒã‚µã‚¤ãƒˆ

- [npm - scripts](https://docs.npmjs.com/cli/v6/using-npm/scripts)
- [GitHub - NPM Scripts By meetKowshik](https://gist.github.com/meetKowshik/66e27b907cf31778d4096fd0e995a2a5)
- [Sass ã®æ•™ç§‘æ›¸ - Sass ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„æ–¹ã‚’è¦šãˆã‚ˆã†](https://book.scss.jp/code/c2/04.html)
- [PostCSS CLI](https://github.com/postcss/postcss-cli)
- [ICS MEDIA - Node.js ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰æŠ¼ã•ãˆã¦ãŠããŸã„ npm-scripts ã®ã‚¿ã‚¹ã‚¯å®Ÿè¡Œæ–¹æ³•ã¾ã¨ã‚](https://ics.media/entry/12226/)
